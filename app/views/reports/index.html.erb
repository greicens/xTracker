<!-- REPORTS INDEX -->
<div class="container">

  <div class="row ">
    <h2>Reports</h2>
    <hr>
    <div class="col s12 m4">
      <%= form_tag reports_path, :method => 'get' do %>
        <!-- SELECT DATE FIELDS  -->
        <h4>Select Period</h4>
          <div class="row">
            <div class="col s4">
              <%= label_tag "From",nil, class:"search-field" %>
              <%= text_field_tag :date_from, params[:date_from] %>
            </div>
            <div class="col s4">
              <%= label_tag "To",nil, class:"search-field" %>
              <%= text_field_tag :date_to, params[:date_to] %>
            </div>
          </div>
        </div>
        <div class="col s12 m8">
          <!-- SELECT FILTERS FIEDS  -->
          <h4>Filter By:</h4>
          <div class="row">
            <div class="col s3">
              <%= label_tag "Transaction Type",nil, class:"search-field" %>
              <%= text_field_tag :entry_type, params[:entry_type] %>
            </div>
            <div class="col s3">
              <%= label_tag "Category",nil, class:"search-field" %>
              <%= text_field_tag :category, params[:category] %>
            </div>
            <div class="col s3">
              <%= label_tag "Payment Type",nil, class:"search-field" %>
              <%= text_field_tag :payment_type, params[:payment_type] %>
            </div>
            <div class="col s3">
              <%= label_tag "Vendor",nil, class:"search-field" %>
              <%= text_field_tag :vendor, params[:vendor] %>
            </div>
          </div>
        </div>
        <div class="row center-align">
          <%= submit_tag "Search", :name => nil, class:"btn" %>
        </div>
        <% end %>

  </div>
  <!-- TABLE TO DISPLAY REPORT DATA -->
  <div class="row">
    <div class="col s8 m10">
      <table >
        <tr>
          <th>Receipt</th>
          <th>Date</th>
          <th>Type</th>
          <th>Category</th>
          <th>ID</th>
          <th>Payment</th>
          <th>Vendor</th>
          <th>Amount</th>
          <th>Options</th>
        </tr>
        <% @entries.each do |entry| %>
          <tr class="hoverable">
            <td><%= image_tag entry.receipt, class:"receipt_preview materialboxed"%></td>
            <td><%= entry.day %></td>
            <td><%= entry.entry_type %></td>
            <td><%= entry.category.name %></td>
            <td><%= entry.category.id %></td>
            <td><%= entry.payment_type %></td>
            <td><%= entry.vendor %></td>
            <td><%= number_to_currency(entry.amount) %></td>
            <td>
              &nbsp;<i class="material-icons">open_with</i>  <%= link_to "view", user_entry_path(current_user,entry), :method => :get %>
              &nbsp;<i class="material-icons">mode_edit</i><%= link_to "Edit", edit_user_entry_path(current_user,entry), :method => :get %>
              &nbsp;<i class="material-icons">delete</i><%= link_to "Delete", user_entry_path(current_user,entry), :method => :delete, data: {confirm: "Are you sure you want to delete this transaction?"} %>
            </td>
          </tr>
        <% end %>
      </table>
      <div class="row right-align", id="total">
        <h4>Total <%= number_to_currency(@entries.sum(:amount)) %></h4>
      </div>
    </div>
    <!-- PIE CHART -->
    <div class="col s2">
      <%= pie_chart @entries.group(:category_id).sum(:amount) %>
    </div>
    <!-- PDF LINK -->
    <div class="row center-align">
      <%= button_to "download pdf", reports_path(:format => :pdf), :method => :get, class:"btn btn-large" %>
    </div>
  </div>
</div>
